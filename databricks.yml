bundle:
  name: geospatial-site-selection

include:
  - resources/bronze_job.yml
  - resources/silver_job.yml
  - resources/gold_job.yml
  - resources/orchestration_job.yml
  - resources/catalog_setup.yml

# Sync configuration files to workspace
sync:
  include:
    - "resources/configs/*.yml"

targets:
  production:
    mode: production
    default: true
    workspace:
      host: https://e2-demo-west.cloud.databricks.com
      root_path: /Workspace/Demo Assets/Retail_Consumer_Goods/geospatial-site-selection
    variables:
      catalog: retail_consumer_goods
      schema: geospatial_site_selection

variables:
  # Unity Catalog
  catalog:
    description: "Unity Catalog name"
    default: "retail_consumer_goods"

  schema:
    description: "Schema name within catalog"
    default: "geospatial_site_selection"

  # Census API Configuration
  census_api_key:
    description: "US Census Bureau API key"
    default: "7f801eabbdf7763d74330e776061901753eb2878"

  acs_year:
    description: "ACS 5-Year ending year"
    default: "2023"

  state_fips:
    description: "State FIPS code (25 = Massachusetts)"
    default: "25"

  # OSM Configuration
  osm_url:
    description: "Geofabrik OSM download URL"
    default: "https://download.geofabrik.de/north-america/us/massachusetts-latest.osm.pbf"

  osm_region:
    description: "OSM region name"
    default: "massachusetts"

  # Cluster Configuration
  node_type:
    description: "Databricks node type"
    default: "m5d.xlarge"

  # GraphHopper Configuration
  graphhopper_volume:
    description: "Path to volume for GraphHopper graph storage"
    default: "/Volumes/retail_consumer_goods/geospatial_site_selection/graphhopper_data/"

  # Isochrone Configuration
  drive_time_buckets:
    description: "Comma-separated list of drive time buckets in minutes"
    default: "5,10,15,20,30"

  time_limit_minutes:
    description: "Maximum search time limit in minutes"
    default: "40"

  tolerance_meters:
    description: "Geometry simplification tolerance in meters"
    default: "50"

  isochrone_input_table:
    description: "Full table name for isochrone input"
    default: "retail_consumer_goods.geospatial_site_selection.rmc_retail_locations_grocery"

  isochrone_output_table_name:
    description: "Output table name (with silver_ prefix)"
    default: "silver_rmc_retail_locations_grocery_isochrones"

  # POI Configuration
  state_filter:
    description: "State filter for POI extraction (e.g., MA for Massachusetts). Leave empty to process entire country."
    default: ""

  # Notifications
  user_email:
    description: "Email address for job notifications"
    default: "samyuktha.thumala@databricks.com"
